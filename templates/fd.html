{% extends "base.html" %}
{% block title %}Fixed Deposit{% endblock %}
{% block content %}
<div class="page-header">
    <div>
        <h2>Fixed Deposit (FD)</h2>
        <p class="page-subtitle">Open and close fixed deposits</p>
    </div>
    <button type="button" class="btn-secondary" onclick="window.history.back()">Back</button>
</div>

<div class="page-tools">
    <a href="{{ url_for('fd_statement') }}" class="btn-secondary">View Statement</a>
</div>

<div class="split-grid">
    <form method="post" class="card form-grid">
        <h3>FD Open</h3>
        <input type="hidden" name="action" value="open">
        <div class="form-row">
            <label>Account No
                <input type="text" name="account_no" required>
            </label>
            <label>Start Date
                <input type="date" name="start_date" value="{{ now.date() }}">
            </label>
        </div>
        <div class="form-row">
            <label>FD Amount
                <input type="number" step="0.01" name="amount" required>
            </label>
            <label>Interest Rate (%)
                <input type="number" step="0.01" name="interest_rate" required>
            </label>
        </div>
        <div class="form-row">
            <label>Period (Months)
                <input type="number" name="period_months" required>
            </label>
        </div>
        <div class="form-row">
            <label>Remarks
                <textarea name="remarks" rows="2"></textarea>
            </label>
        </div>
        <div class="form-actions">
            <button type="submit" class="btn-primary">Open FD</button>
            <button type="reset" class="btn-secondary">Clear</button>
        </div>
    </form>

    <form method="post" class="card form-grid">
        <h3>FD Close</h3>
        <input type="hidden" name="action" value="close">
        <div class="form-row">
            <label>FD ID
                <input type="text" name="fd_id" placeholder="Enter FD ID to close" required>
            </label>
            <label>Close Date
                <input type="date" name="close_date" value="{{ now.date() }}">
            </label>
        </div>
        <div class="form-row">
            <label>Amount Paid
                <input type="number" step="0.01" name="amount_paid" required>
            </label>
        </div>
        <div class="form-row">
            <label>Remarks
                <textarea name="remarks" rows="2"></textarea>
            </label>
        </div>
        <div class="form-actions">
            <button type="submit" class="btn-primary">Close FD</button>
        </div>
    </form>
</div>

<div class="card table-card">
    <h3>Recent FDs</h3>
    <div class="table-wrapper">
        <table>
            <thead>
            <tr>
                <th>Account</th>
                <th>Name</th>
                <th>Start</th>
                <th>Amount</th>
                <th>Rate</th>
                <th>Maturity Date</th>
                <th>Maturity Amount</th>
                <th>Status</th>
            </tr>
            </thead>
            <tbody>
            {% for f in fds %}
                <tr>
                    <td>{{ f.account_no }}</td>
                    <td>{{ f.member_name }}</td>
                    <td>{{ f.start_date }}</td>
                    <td>{{ "%.2f"|format(f.amount) }}</td>
                    <td>{{ "%.2f"|format(f.interest_rate) }}%</td>
                    <td>{{ f.maturity_date }}</td>
                    <td>{{ "%.2f"|format(f.maturity_amount) }}</td>
                    <td>{{ 'Closed' if f.is_closed else 'Open' }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
